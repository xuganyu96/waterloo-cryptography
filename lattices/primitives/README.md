# Lattice primitives

Implementation of primitive components used in lattice cryptography, such as:

- [ ] Modular arithmetic in the prime field (q=3329)
- [ ] Polynomial ring and its NTT transformation
- [ ] Sampling from uniform distribution or centered binomial distribution
- [ ] Ciphertext rounding and compression

## NTT for Kyber
Kyber's choice of polynomial ring is

$$
R_q = \frac{\mathbb{Z}_q[x]}{
    \langle x^{256} + 1\rangle
}
$$

where $q = 3329, n = 256$. Because 3329 is a prime, $\mathbb{Z}_{3329}^\ast$ has a primitive root and is thus a cyclic group. In addition, $3329 = 2^8 \times 13$, so there exists a subgroup of order $2^8$ but not a subgroup of order $2^9$. The NIST specification chose the subgroup generated by $17$:

$$
17 ^ {256} \equiv 1 \mod 3329
$$

On the other hand, $17 ^ {128} \equiv 3328 \equiv -1 \mod 3329$ (in fact, $17^{128}$ is a square root of 1, but it must not be 1 or $17$'s order can't be 256, so it must be $-1$), therefore, $\zeta = 17$ is a root of the polynomial $x^{128} + 1$. Because $17$ has order $256$, all of its odd powers up to 255 are distinct elements of the integer ring, and they are all roots to the same polynomial. This gives us 128 distinct roots, which completely factors the polynomial:

$$
x^{128} + 1 = (x  - \zeta)(x - \zeta^3)\ldots(x - \zeta^{255})
$$

A simple substitution gives us some factorization of the quotient polynomial used in Kyber:

$$
x^{256} + 1 = (x^2)^{128} + 1 = (x^2  - \zeta)(x^2 - \zeta^3)\ldots(x^2 - \zeta^{255})
$$

By the (extended) Chinese Remainder Theorem, we have the following ring isomorphism:

$$
R_q \cong 
\frac{\mathbb{Z}_q[x]}{
    \langle x^2 - \zeta \rangle
}
\times \frac{\mathbb{Z}_q[x]}{
    \langle x^2 - \zeta^3 \rangle
}
\times \ldots
\times \frac{\mathbb{Z}_q[x]}{
    \langle x^2 - \zeta^{255} \rangle
}
$$
