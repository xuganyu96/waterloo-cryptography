\documentclass{article}
\usepackage[margin=1in,letterpaper]{geometry}
\usepackage{amsmath,amsfonts,amssymb,amsthm}

% For source code
\usepackage{listings}

% Algorithms and pseudocode
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage{algpseudocode}
\usepackage{multicol}

% Common shortcuts
\newcommand{\monospace}{\texttt}
\newcommand{\pke}{\monospace{PKE}}
\newcommand{\keygen}{\monospace{KeyGen}}
\newcommand{\encrypt}{\monospace{E}}
\newcommand{\decrypt}{\monospace{D}}
\newcommand{\kem}{\monospace{KEM}}
\newcommand{\encap}{\monospace{Encap}}
\newcommand{\decap}{\monospace{Decap}}
\newcommand{\etm}{\monospace{EtM}}  % encrypt-then-mac
\newcommand{\mac}{\monospace{MAC}}
\newcommand{\sign}{\monospace{MAC}}
\newcommand{\verify}{\monospace{MAC.Verify}}
\newcommand{\pk}{\monospace{pk}}
\newcommand{\sk}{\monospace{sk}}
\newcommand{\pco}{\monospace{PCO}}
\newcommand{\cvo}{\monospace{CVO}}
\newcommand{\leftsample}{\stackrel{\$}{\leftarrow}}
\newcommand{\llbrack}{[\![}
\newcommand{\rrbrack}{]\!]}
\newcommand{\norm}[1]{\left\lvert #1 \right\rvert}

% Environments: definitions, theorems, propositions, corollaries, lemmas
%    Theorems, propositions, and definitions are numbered within the section
%    Corollaries are numbered within the theorem, though they are rarely used
\newtheorem{definition}{Definition}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{remark}{Remark}
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}{Lemma}[theorem]


\title{Some implementation considerations}
\author{Ganyu (Bruce) Xu (g66xu)}
% \date{June, 2024}

\begin{document}
%%%% TITLE %%%%%
\maketitle

\section{One-time MAC}
The challenge encryption $c^\ast$ in the \monospace{OW-PCVA} game is computed using a uniformly randomly sampled plaintext message $m^\ast \leftsample \mathcal{M}_\pke$, and a $\mac$ key $k_\mac$ derived from said plaintext $m^\ast$. Assuming that $m^\ast$ is not already known (otherwise the \monospace{OW-CPA} security of the underlying $\pke$ is already broken), then $k^\ast_\mac$ is also not known, so the \monospace{OW-PCVA} adversary has no way to evaluate the $\mac$ under $k^\ast_\mac$ offline.

Furthermore, I propose that the \monospace{OW-PCVA} adversary also has no way of issuing signing queries for $k^\ast_\mac$. The adversary can run $\encrypt$ or $\encap$ offline, but the tags generated from $\encrypt$ or $\encap$ will be associated with a chosen message or a random message, which has $\frac{1}{\norm{\mathcal{M}_\pke}}$ probability of being $m^\ast$. In other words, for the challenge $\mac$ key, the adversary will only see one valid message-tag pair, which is the challenge message $(c^\ast, t^\ast)$.



\section{Choice of MAC}
When thinking about choosing a MAC there are two parameters that we need to care about: the key size and the tag size.

Whether working with Round 3 Kyber \cite{avanzi2019crystals} or ML-KEM \cite{key2023mechanism}, the message is always 256 bits in size, and since the MAC key is derived from the message, the MAC key should also always be 256 bits. A 256-bit MAC key is great since both GCM and Poly1305 accepts 256-bit MAC keys.

Reasoning about the security implication of the tag size is more nuanced.

\subsection{Generic collision resistance}
We can model a MAC has a keyed hash function, which means that for a fixed MAC key, we can argue about the seurity of a MAC using the standard security notions for hash function: pre-image resistance, 2nd pre-image resistance, and collision resistance.

However, there is an important distinction between the security of a MAC as a keyed hash function and the security of a hash function. With MAC as a keyed hash function, assuming that the adversary doesn't already have a way to evaluating this function offline (otherwise forgery is trivial), \textbf{it has to query the signing oracle to evaluate the hash function}. Given an n-bit tag, a generic birthday attack takes $2^{\frac{n}{2}}$ evaluations to find a collision, and the BHT algorithm \cite{brassard1997quantum} takes $2^{\frac{n}{3}}$ evaluations to find a collision, but neither attack is relevant, because "evaluation" means that the message-tag pair is queried from the signing oracle and \textbf{does not count as forgery}.

This means that we only need to care about preimage resistance for our MAC (as a keyed hash function), 

\subsection{Offline versus online attacks}
There should be a distinction between attacks that involve interaction with another party (online) versus attacks that can be done without such interaction (offline). When we measure the security of a scheme by the number of computational steps needed to carry out an attack, we specifically mean an offline attack. \textbf{An online attack with substantial number of interactions can be trivially thwarted} because the other party can implement rate limiting with exponential backoff, so after only a few (think fewer than 10 password tries) invalid interactions, the other party will effectively block the adversary from further interactions, thus stopping the attack in the track.

\textbf{Adversary obtains $(c, t)$}, tampers with $c$ to obtain $c^\prime$ which still correspond with the same plaintext $m$, which means that $t^\prime$ should be created under the same key $(c, t)$ is created.

\bibliographystyle{plain}
\bibliography{./references.bib}
\end{document}