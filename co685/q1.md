# Problem 1
Suppose that $\mathcal{A}_\text{EUF-CMA}$ is an EUF-CMA adversary who can forge, with non-negligible probability, valid signature $(m, \sigma_1, \sigma_2)$. By the forking lemma, a replay of $\mathcal{A}_\text{EUF-CMA}$ on the same input $(p, G, g, g^x)$ has a non-negligible probability of returning a distinct valid forgery on the same message $(m, \sigma_1^\prime, \sigma_2^\prime)$.

In the forked replay of the EUF-CMA attack, the random tape remains unchanged, so the choice of the commit $g^r$ is the same. On the other hand, in the forked replay of the attack, the random oracle is manipulated so as to still output uniformly sampled random element, but these elements are not necessarily the same as they are in the initial attack. This means that $\sigma_1 \neq \sigma_1^\prime$.

From here we can observe the following:

$$
\begin{aligned}
\frac{\sigma_2^\prime - \sigma_2}{\sigma_1^\prime - \sigma_1}
&= \frac{(r + \sigma_1^\prime x) - (r + \sigma_1x)}{\sigma_1^\prime - \sigma_1} \\
&= \frac{(\sigma_1^\prime - \sigma_1)x}{\sigma_1^\prime - \sigma_1} \\ 
&= x
\end{aligned}
$$

Which is the discrete log of the public key.

In other words, if there exists an EUF-CMA adversary $\mathcal{A}_\text{EUF-CMA}$ who can forge signatures with non-negligible probability, then we can build a second adversary $\mathcal{A}_\text{DLog}$ such that $\mathcal{A}_\text{DLog}$ gives its input $(g, g^x)$ to $\mathcal{A}_\text{EUF-CMA}$ runs $\mathcal{A}_\text{EUF-CMA}$ twice on the same input and random tape but a different random oracle. From the two related runs, $\mathcal{A}_\text{DLog}$ can use the two pairs of distinct forgeries on the same message to recover $x$, thus solving the discrete log.